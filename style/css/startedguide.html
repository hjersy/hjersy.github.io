<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="shortcut icon" href="../../assets/ico/favicon.ico">


    <title>Started Guide</title>

    <!-- Bootstrap core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="style.css" rel="stylesheet">

    <!-- Just for debugging purposes. Don't actually copy this line! -->
    <!--[if lt IE 9]><script src="../../assets/js/ie8-responsive-file-warning.js"></script><![endif]-->

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>

  <body>

    <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <div class="logo"><a href="index.html"><img src="img/flydata.png" alt="" /></a></div>
        </div>
      </div>
    </div>

    <!-- Main jumbotron for a primary marketing message or call to action -->
    <div class="jumbotron">
      <div class="container">
        <h1>Getting Started</h1>
        <p>Welcome to FlyData for Redshift! After installation and setup of our client, you won’t need to do anything and FlyData just starts working. Setup is also easy so let’s start!</p>
      </div>
    </div>

    <div class="container">
      <!-- Example row of columns -->
        <h2>Overview</h2>  
    <ul class="overview_list">
        <li>
        <a href="#step1">STEP 1. Launch Redshift Free Trial instance</a> 
        </li>
        <li>
        <a href="#step2">STEP 2. Create FlyData account</a> 
        </li>
        <li>
        <a href="#step3">STEP 3. Register Redshift to FlyData</a> 
        </li>
        <li>
        <a href="#step4">STEP 4. Register RDS MySQL to FlyData</a> 
        </li>
        <li>
        <a href="#step5">STEP 5. Install FlyData client</a> 
        </li>
        <li>
        <a href="#step6">STEP 6. Start FlyData Sync</a> 
        </li>
    </ul>
    <!--STEP 1-->
    <div>
        <a id="step1" name="step1"></a>
        <h3>STEP 1. Launch Redshift Free Trial instance</h3>
        <p>Go to <a href="http://secure.flydata.co">secure.flydata.com</a> and create an account</p>
    </div>
    <!--STEP 2-->
    <div>
        <a id="step2" name="step2"></a>
        <h3>STEP 2. Create FlyData account</h3>
        <p>Go to <a href="http://secure.flydata.co">secure.flydata.co</a> and create an account</p>
    </div>
    <!--STEP 3-->
    <div>
        <a id="step3" name="step3"></a>
        <h3>STEP 3. Register Redshift to FlyData</h3>
        <h4>3.1. Change Reshift security setting to allow FlyData to access Redshift</h4>
        <P>For FlyData to upload data to your Redshift cluster, FlyData data servers need to be able to access to your Redshift cluster.

The following IP addresses need access to the cluster's endpoint:port 
(e.g. endpoint: myredshift.cywlg1ayhkjv.us-east-1.redshift.amazonaws.com, port: 5439)</P>
        <p><code>54.235.208.92</code></p>
        <p><code>54.235.208.103</code></p>
        <div class="panel-group" id="accordion">
            <div class="panel panel-default">
                <div class="panel-heading" data-toggle="collapse" data-parent="#accordion" href="#collapseOne">
                    <h4 class="panel-title"> 3.1.1. A: For Non-VPC </h4>
                </div>
                <div id="collapseOne" class="panel-collapse collapse">
                    <div class="panel-body">
                        <ol>
                            <li>On your Redshift Cluster's AWS Console page, click on a security group specified as the Cluster Security Groups</li>
                            <li>Authorize FlyData IPs</li>
                                <ul>
                                    <li>Choose <code>CIDR/IP</code> Connection Type</li>
                                    <li>Enter <code>54.235.208.92/32</code> in CIDR/IP to Authorize field and click Authorize</li>
                                    <li>Choose <code>CIDR/IP</code> Connection Type</li>
                                    <li>Enter <code>54.235.208.103/32</code> in CIDR/IP to Authorize field and click Authorize</li>
                                </ul>
                        </ol>
                    </div>
                </div>
            </div>
            <div class="panel panel-default">
                <div class="panel-heading" data-toggle="collapse" data-parent="#accordion" href="#collapseTwo">
                    <h4 class="panel-title">3.1.2. B:  For VPC</h4>
                </div>
                <div id="collapseTwo" class="panel-collapse collapse">
                    <div class="panel-body">
                        <ol>
                            <li>On your Redshift Cluster's AWS Console page</li>
                            <ul>
                                <li>From VPC Security Groups, take note of a security group you'd like to add FlyData IP addresses (e.g. default (sg-           8cde8f18))</li>
                                <li>Click on "View VPC Security Groups" link</li>
                                <li>Search for the security group by entering its group ID in the search box (e.g. sg-8cde8f18)</li>
                            </ul>
                            <li>Authorize FlyData IPs</li>
                            <ul>
                                <li>Click on "Inbound" tab</li>
                                <li>Click on "Edit" button --> "Edit inbound rules" dialog pops up</li>
                                <li>Click on "Add Rule" button</li>
                                <li>Type: <code>Custom TCP Rule</code>, Port Range: your Redshift cluster port (e.g. 5439), Source: 
                                    <code>Custom IP</code>: <code>54.235.208.92/32</code></li>
                                <li>Click on "Add Rule" button</li>
                                <li>Type: <code>Custom TCP Rule</code>, Port Range: your Redshift cluster port (e.g. 5439), Source: <code>Custom IP</code>: <code>54.235.208.103/32</code></li>
                                <li>Click on "Save" button to save the settings</li>
                            </ul>
                        </ol>
                  </div>
                </div>
            </div>
        </div>

        <h4>3.2. Register Redshift cluster to FlyData</h4>
        <p>To register your own Redshift cluster, go to the FlyData Settings page and enter the Redshift cluster connection parameters.</p>
        <div class="screenshot_half">
            <img src="img/setting_cluster.png" alt="console_screenshot" width="100%">
            <img src="img/setting_cluster.png" alt="console_screenshot" width="100%">
        </div>
        
    </div>
    <!--STEP 4-->
    <div>
        <a id="step4" name="step4"></a>
        <h3>STEP 4. Register RDS MySQL to FlyData</h3>
        <h4>4.1. Create a read replica</h4>
        <ol>
            <li>Launch new read replica</li>
            <ul>
                <li>Instance Actions -> Create Read Replica</li>
            </ul>
            <li>Create DB Parameter Group for Sync</li>
                <ul>
                    <li>Parameter Groups -> Create DB Parameter Group</li>
                    <ul>
                        <li>DB Parameter Group Family: <code>mysql5.6</code></li>
                        <li>DB Parameter Group Name: <code>mysql56sync</code></li>
                        <li>DB Parameter Group Description: <code>MySQL5.6 for Sync</code></li>
                    </ul>
                    <li>Hit Yes, Create</li>
                    <li>Click on the icon next to the newly created parameter group mysql56sync</li>
                    <li>Click on Edit Parameters and edit the following parameter values</li>
                    <ul>
                        <li>binlog_format: <code>ROW</code></li>
                        <li>binlog_checksum: <code>NONE</code></li>
                        <li>log_bin_use_v1_row_events: <code>1</code></li>
                        <li>read_only: <code>0</code></li>
                    </ul>
                    <li>Hit Save Changes</li>
                </ul>
            <li>Configure the read replica</li>
                <ul class="task-list">
                    <li>Instance Actions -&gt; Modify</li>

                        <ul class="task-list">
                            <li>DB Engine Version: <code>MySQL 5.6.xx</code></li>
                            <li>DB Parameter Group: <code>mysql56sync</code> (DB parameter group you created <a href="https://github.com/hapyrus/hapyrus-docs/wiki/%5BTechDoc%5D-Getting-Started-Guide-for-Redshift-Free-Trial-users#create_param_group">here</a>)</li>
                            <li>New Master Password: <code>your password</code> (Need this to reset default parameters.  Put the same password if you wish to keep the same password as the master's)</li>
                            <li>Apply Immediately: <code>Check</code></li>
                        </ul>

                    <li>Hit Continue</li>
                    <li>When asked for a confirmation, hit Modify DB Instance</li>
                    <li>Wait until the instance becomes available</li>
                    <li>Instance Actions -&gt; Modify</li>

                    <ul class="task-list">
                        <li>Backup Retention Period: <code>7</code></li>
                        <li>Apply Immediately: <code>Check</code></li>
                    </ul>
                    <li>Wait until the instance becomes available</li>
                </ul>
                <li>Complete setup of the read replica</li>

                <ul>
                    <li>Log in to the read replica DB from a MySQL client with the master account</li>
                    <li>Create a user for Sync</li>
                    
<pre class="mysql"><code>mysql> CREATE USER 'sync'@'%' IDENTIFIED BY 'your_password';</code>
<code>mysql> GRANT REPLICATION SLAVE, SELECT, RELOAD, REPLICATION CLIENT, LOCK TABLES ON *.* TO 'sync'@'%';</code>  
<code>mysql> FLUSH PRIVILEGES;</code></pre>
                    
                    <li>Retain binary log for 24 hours</li>
                    <pre><code>mysql> call mysql.rds_set_configuration('binlog retention hours', 24);</code></pre>
                </ul>
                
            </ol>
        <h4>4.2. Register the read replica to FlyData</h4>
        <p>Enter connect info of the read replica to FlyData data entry page including a database name and table names to synchronize</p>
    </div>
    <!--STEP 5-->
    <div>
        <a id="step5" name="step5"></a>
        <h3>STEP 5. Install FlyData client</h3>
        <P>FlyData client receives MySQL binary log from your MySQL server and send change records to Flydata Cloud which then applies the changes to your Redshift tables. You run the client on a Linux server which has access to your MySQL server. If you don't have a server already, you can launch a new EC2 instance in your AWS with the following steps. If you already have a server on which you can install FlyData client, you may skip to the next section.</P>
        <h4>5.1. Launch an EC2 instance for FlyData client</h4>
        <ol>
            <li>From AWS Console, choose EC2</li>
            <li>Click on "Launch Instance"</li>
            <li>Click on Select to choose Amazon Linux AMI</li>
            <li>Choose m1.small Instance Type</li>
            <li>Click on Review and Launch</li>
            <li>Click on Launch</li>
            <li>Create or choose a key pair to login to the EC2 instance</li>
            <li>Wait until the instance becomes available</li>
            <li>Login the instance with the following command</li>
        </ol>
        <pre class="terminal"><code>$ ssh -i your_public_key ec2-user@your-instance-public-DNS</code></pre>
        <p>e.g.</p>
        <pre class="terminal"><code>$ ssh -i ~/.ssh/id_rsa.pub ec2-user@ec2-23-20-136-106.compute-1.amazonaws.com</code></pre>
        <h4>5.2. Install FlyData client</h4>
        <p>Install command of the FlyData client is available in your FlyData Dashboard. An install command looks like this:</p>
        <pre class="terminal"><code>curl -L https://secure.flydata.co/i/your-unique-identity | bash</code></pre>
        <p>Copy your install command from the Dashboard and run on your Linux server.</p>

    </div>
    <!--STEP 6-->
    <div>
        <a id="step6" name="step6"></a>
        <h3>STEP 6. Start FlyData Sync</h3>
        <h4>6.1. Generate Redshift table definition script and run on Redshift</h4>
        <pre class="terminal"><code>$ flydata sync:generate_table_ddl &gt; create_table.sql
$ cat create_table.sql</code></pre>
        <p>Copy the output and run it from FlyData's <a href="">Redshift Access Console</a></p>
        <h4>6.2. Start Sync</h4>
        <pre class="terminal"><code>$ flydata sync</code></pre>
    </div>
    <!--What's next?-->
    <div>
        <h3>What’s next?</h3>
        <p>You can run queries against your Redshift cluster now via a Postgres client. FlyData will automatically upload any new data from your specified logs onto FlyData every 5 minutes. Note that it may take up to 1 hour to see changes on your S3 bucket. Data will then be copied onto the Amazon Redshift cluster once an hour.</p>
        <div class="screenshot">
            <img src="img/console.png" alt="console_screenshot" width="100%">
        </div>
    </div>    
        
    </div> <!-- /container -->
    <footer>
        <p>Copyright &copy; 2014 FlyData. All Rights Reserved.</p>
    </footer>



    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="js/bootstrap.min.js"></script>
  </body>
</html>
